# 冥想呼吸引导网页（MVP）需求文档

更新时间：2026-02-18

## 1. 背景与目标
用户希望通过网页进行呼吸冥想练习。网页可配置“吸气/暂停/呼气/暂停”的时长，并在每次阶段切换时播放对应提示音，配合简洁的视觉动画与倒计时，引导用户完成在指定总时长内的练习。

## 2. 范围（MVP 包含）
- 4 段呼吸循环：`吸气 → 暂停(屏息1) → 呼气 → 暂停(屏息2)`
- 用户可分别输入：吸气秒数、屏息1秒数、呼气秒数、屏息2秒数
- 用户输入总时长（分钟），开始后运行到时间结束，并“完成当前整轮后再停止”
- 声音提示：进入每个阶段时播放一次提示音（3 种音色分别表达吸气/暂停/呼气）
- 视觉引导：圆形（或同类图形）随吸气变大、呼气变小、暂停保持；显示当前阶段与倒计时
- 控制：开始、暂停、继续、停止/重置、静音、音量

## 3. 非目标（MVP 不做）
- 不做阶段内节拍（例如每秒提示）
- 不做账号/登录/云同步
- 不做复杂音源库、音乐编排、背景环境音（可作为后续增强）
- 不做高级统计（历史记录、趋势图）

## 4. 用户故事
1. 作为用户，我能输入 4 个阶段时长与总时长（分钟），点击开始即可获得呼吸引导。
2. 作为用户，我能通过不同的声音快速感知当前进入“吸气/暂停/呼气”。
3. 作为用户，我能随时暂停并继续，或停止并重置。
4. 作为用户，我能静音或调整音量。

## 5. 交互与页面结构（建议）
- 顶部：标题“呼吸冥想” + 简短提示（如“请佩戴耳机，点击开始以启用声音”）
- 参数区（表单）：
  - 吸气（秒）
  - 暂停1（秒）
  - 呼气（秒）
  - 暂停2（秒）
  - 总时长（分钟）
- 控制区：开始 / 暂停 / 继续 / 停止（或重置）/ 静音 / 音量滑杆
- 引导区（主视觉）：
  - 动画圆形（吸气扩大、呼气缩小、暂停保持）
  - 当前阶段文案（吸气/暂停/呼气/暂停）
  - 阶段剩余秒数
  - 总剩余时间（分钟级显示即可，也可显示 mm:ss）

## 6. 输入校验与默认值（MVP 建议）
- 吸气/呼气：最小 1 秒
- 暂停1/暂停2：允许 0 秒（表示跳过该暂停阶段）
- 总时长：最小 1 分钟
- 默认值建议：吸气 4、暂停1 4、呼气 4、暂停2 4、总时长 5 分钟
- 非法输入（空值/负数/NaN）时禁止开始，并提示错误位置

## 7. 呼吸时序与停止规则
### 7.1 阶段定义
- 阶段类型：Inhale（吸气）、Hold（暂停）、Exhale（呼气）
- 其中 Hold 会出现两次：Hold1（吸气后暂停）、Hold2（呼气后暂停）

### 7.2 运行规则
- 点击“开始”后：
  - 进入吸气阶段，开始倒计时
  - 每阶段结束立即切换到下一阶段
  - 当某个暂停阶段时长为 0 秒时，该阶段应被跳过（无倒计时；是否播放暂停音：MVP 建议“直接跳过且不播放”，避免打断节奏）

### 7.3 总时长停止
- 总时长按“分钟”输入与展示。
- 运行过程中累计已用时间；当“已用时间 ≥ 总时长”时：
  - 不立即停止；设置“待停止”标记
  - 在完成当前整轮（即完成 Hold2 后）自动停止，并进入“已结束”状态

## 8. 声音设计（MVP 方案）
### 8.1 声音语义映射（确定）
- 进入吸气：鼓声
- 进入暂停（Hold1/Hold2）：水滴声
- 进入呼气：轻柔的乐器音（例如铃/木琴/拇指琴风格，不是音量很小的提示音）

### 8.2 实现建议
- 优先用 Web Audio API 合成三种音色（无需外部素材，便于快速交付）；后续可替换为音频文件。
- 关键约束：浏览器通常要求用户手势才能发声，因此“开始”按钮需要同时触发音频上下文启用（AudioContext resume）。

### 8.3 音量与静音
- 音量滑杆（0–100%）影响全部提示音
- 静音开关优先级高于音量

## 9. 可访问性与体验要求（MVP）
- 明确的开始提示：提醒用户点击开始以启用声音
- 页面在移动端可用（按钮足够大、布局自适应）
- 允许仅视觉引导（静音情况下仍可正常使用）

## 10. 验收标准（MVP）
- 能输入并保存当前表单值（至少在本次页面生命周期内保持；可选 localStorage）
- 点击开始后，阶段顺序与时长准确，阶段切换时播放对应音色
- 暂停/继续后，倒计时与阶段状态不紊乱，声音不重复乱响
- 总时长到达后，能在“本轮结束”时自动停止
- 静音/音量生效，且不影响计时

## 11. 后续增强（可选）
- 预设方案（4-7-8、方形呼吸 4-4-4-4 等）
- 倒计时准备（3 秒）
- 背景环境音（雨声/白噪音）与提示音分音量
- PWA 离线使用
- 更丰富的视觉（渐变、呼吸光圈、震动反馈）
